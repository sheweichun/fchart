
<p align="center">
    <img  src="https://user-gold-cdn.xitu.io/2019/4/22/16a442821e5c550a?w=200&h=147&f=svg&s=2117"><br/>
</p>
# æ•™ä½ å¼€å‘å›¾è¡¨åº“fchartç³»åˆ—ç¬¬ä¸€ç« 

[å·¥ç¨‹åˆ†æ”¯](https://github.com/sheweichun/fchart/blob/Chapter_One/dev_doc/Chapter_One.md)


æ•´ä¸ªç³»åˆ—é‡Œä½œè€…ä¼šå¸¦ç€å¤§å®¶ä¸€èµ·å®Œæˆä¸€ä¸ªä»0åˆ°1å›¾è¡¨åº“çš„å¼€å‘ï¼Œæ¬¢è¿æ¥[è¿™é‡Œ](https://github.com/sheweichun/fchart)è¸Šè·ƒæ‹ç –

ä¼°è®¡å¾ˆå¤šäººä¼šé—®ï¼Œç°åœ¨å¼€æºä¸–ç•Œé‡Œçš„å›¾è¡¨åº“å¤šå¦‚ç‰›æ¯›ï¼Œä¸ºä»€ä¹ˆè‡ªå·±è¿˜è¦å†å¼„ä¸ªå›¾è¡¨åº“å‘¢?
* å¼€å‘åº“å¾ˆå¤šä¸å‡ï¼Œä½†æ˜¯æˆç†Ÿçš„æ¡†æ¶éƒ½æ˜¯å¤§è€Œå…¨çš„ï¼Œå­¦ä¹ æˆæœ¬é«˜ï¼Œè€Œå®é™…ä¸šåŠ¡ä¸­ä½¿ç”¨çš„å›¾è¡¨éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå°¤å…¶æ˜¯ç§»åŠ¨ç«¯æ›´æ˜¯è¦æ±‚ç²¾ç®€ï¼Œä½†å³ä¾¿ç®€å•çš„å›¾è¡¨ä¹Ÿä¼šæºæ‚ä¸ªæ€§åŒ–çš„éœ€æ±‚ï¼Œè¿™ä¸ªæ—¶å€™å—æ¡†æ¶çš„é™åˆ¶ä½ ä¼šæœ‰ä¸€ç§æ— åŠ›æ„Ÿ
* è¿™æ—¶å€™å¦‚æœä½ è‡ªå·±æœ‰ä¸€ä¸€å¥—åŸºç¡€å›¾è¡¨åº“ï¼Œæ—¢èƒ½æ»¡è¶³æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ï¼Œåˆèƒ½æ»¡è¶³è€æ¿å¯¹å¯è§†åŒ–ä¸ªæ€§åŒ–å®šåˆ¶ï¼Œä¼šè®©ä½ è§‰å¾—ç”Ÿæˆå¦‚æ­¤æƒ¬æ„~~
* å½“ç„¶å¦‚æœæœ€åè¿™ä¸ªåº“å¼€å‘å¤±è´¥äº†ï¼Œå°±æƒå½“å­¦ä¹ å¥½äº†


åœ¨å…·ä½“å¼€å§‹æ’¸ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æƒ³æ¸…æ¥šå›¾è¡¨çš„ç»„æˆéƒ¨åˆ†ï¼Œè¿™ä¸ªåº“çš„æ¶æ„æ˜¯æ€æ ·çš„ï¼Œå¼€å‘è€…å¦‚ä½•ä½¿ç”¨ç­‰ç­‰ï¼Œå½¢è±¡ç‚¹è¯´å°±æ˜¯æˆ‘ä»¬å…ˆå¼„ä¸€ä¸ªæ–½å·¥å›¾å‡ºæ¥


## Demoæ¼”ç¤º
ä¸‹é¢è¿™ä¸ªåŠ¨å›¾å°±æ˜¯æˆ‘ä»¬æœ¬æ¬¡è¦å®ç°çš„æ•ˆæœ,åŒ…å«äº†Xè½´ã€Yè½´ã€æŠ˜çº¿å›¾ã€æŸ±å½¢å›¾å’ŒåŠ¨ç”»

![](./demo.gif)


## å›¾è¡¨ç»„æˆ

é™äºæˆ‘ä»¬çš„å›¾è¡¨ç°åœ¨è¿˜æ²¡æ•´å‡ºæ¥ï¼Œæˆ‘ä»¬èµ°ä¸€æ¬¡æŠ½è±¡æ´¾ï¼Œè§ä¸‹å›¾

![](https://user-gold-cdn.xitu.io/2019/4/22/16a44282232087e3?w=934&h=426&f=png&s=10235)

è¿™æ˜¯å›¾å±•ç¤ºäº†ä¸€ä¸ªæœ€åŸºæœ¬çš„å›¾è¡¨çš„ç»„æˆéƒ¨åˆ†(**æˆ‘ä»¬ç”±æµ…å…¥æ·±**)ï¼Œå®ƒåŒ…å«ä»¥ä¸‹éƒ¨åˆ†:

* Xè½´
* Yè½´
* ç»˜åˆ¶åŒºåŸŸ
* å„ç§ç±»å‹å›¾
* å›¾ä¾‹
* æç¤ºä¿¡æ¯
* è¾…åŠ©å…ƒç´ 
* æ ‡é¢˜ã€å‰¯æ ‡é¢˜


## åˆæ­¥å»ºæ¨¡


![](https://user-gold-cdn.xitu.io/2019/4/22/16a442822248b9f5?w=1768&h=904&f=png&s=35827)



## ç¼–ç¨‹è¯­è¨€é€‰æ‹©

é€‰æ‹©typescriptï¼Œå¥½å¤„æœ‰ä¸€ä¸‹å‡ ç‚¹
* å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
* å¢å¼ºäº†ç¼–è¾‘å™¨å’Œ IDE çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»£ç è¡¥å…¨ã€æ¥å£æç¤ºã€è·³è½¬åˆ°å®šä¹‰ã€é‡æ„ç­‰
* æœªæ¥å¼€å‘è€…ä½¿ç”¨çš„æ—¶å€™èƒ½å¤Ÿåšåˆ°é…ç½®è‡ªåŠ¨æç¤º

å¦‚æœä½ æ˜¯typescriptæ–°æ‰‹ï¼Œå»ºè®®ä½ ä¸Šå®˜ç½‘[ä¸­æ–‡å®˜ç½‘](https://www.tslang.cn/)å­¦ä¹ å­¦ä¹ 

## Coding

### åæ ‡è½´

ç”±å‰é¢å›¾åˆ†æï¼Œæˆ‘ä»¬ä¼šæä¾›åŸºç¡€Axisï¼Œç„¶ååœ¨Axisä¸Šåˆ†åˆ«æŠ½è±¡å‡ºYAxis,XAxis

#### [Axis]((https://github.com/sheweichun/fchart/blob/a8fd713e0d3939cea8bb65bdad44ed7ca82f3fc4/src/widgets/axis.ts#L212))

* [æ„é€ å‡½æ•°](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/widgets/axis.ts#L230)

```typescript
...
constructor(opt:AxisOpt){
    this.data = (opt.data || []) as string[] //labelæ•°æ®
    const mergeOpt = assign({},defaultAxisOpt,opt || {}) as AxisOpt;
    const {x,y,length,axisTick,axisLabel,axisLine,horizontal,reverse,splitNumber,boundaryGap} = mergeOpt;
    this.boundaryGap = boundaryGap;
    /*x,yä¸ºè½´çº¿çš„ä¸­å¿ƒ */
    this.x = x; 
    this.y = y; 
    const dLen = this.data.length - 1
    const rSplitNumber =  splitNumber || dLen; //è½´è¦åˆ†æˆå‡ æ®µ
    this.tickUnit = Math.ceil(dLen / rSplitNumber); // tickä¹‹é—´åŒ…å«çš„æ•°æ®ç‚¹ä¸ªæ•°,ä¸åŒ…å«æœ€åä¸€ä¸ª
    this.unitWidth = length / (dLen + ( this.boundaryGap ?  this.tickUnit : 0)); //æ¯ä¸ªæ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»
    this.tickWidth = this.tickUnit * this.unitWidth; //æ¯ä¸ªtickçš„å®½åº¦
    this.length = length; //è½´é•¿åº¦
    ... //çœç•¥æ‰ä¸€äº›é…ç½®å‚æ•°çš„è§£æ 
    this.parseStartAndEndPoint(mergeOpt); //è§£æè½´çº¿çš„èµ·ç‚¹startå’Œç»ˆç‚¹end
    if(horizontal){
        this.textAlign = "center";
        this.textBaseline = reverse ? "bottom" : "top";
        this.createHorizontatickAndLabels(mergeOpt) //åˆ›å»ºæ¨ªå‘çš„åˆ»åº¦å’Œlabel
    }else{
        this.textAlign = reverse ? "left" : "right";
        this.textBaseline = "middle";
        this.createVerticatickAndLabels(mergeOpt); //åˆ›å»ºå‚ç›´çš„åˆ»åº¦å’Œlabel
    }
}
...
```

å¤§éƒ¨åˆ†è¿˜æ˜¯å‚æ•°çš„è§£æï¼Œæ ¸å¿ƒæˆ‘ä»¬è¿˜æ˜¯çœ‹ä¸‹createHorizontatickAndLabels

* [createHorizontatickAndLabels](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/widgets/axis.ts#L262)
```typescript
createHorizontatickAndLabels(opt:AxisOpt){
    const ticks = []; //åˆ»åº¦åˆ—è¡¨
    const labels = []; //labelåˆ—è¡¨
    let count = 0;
    let i:number;
    const {boundaryGap} = this;
    const {x,y,reverse,tickLen,length,labelBase,offset} = opt;
    const baseX = (x-length/2) //èµ·ç‚¹çš„xå€¼
    /* è®¾ç½®äº†boundaryGapï¼Œåˆ™è¡¨ç¤ºåœ¨åœ¨è½´çš„å·¦å³ä¸¤ä¾§åˆ†åˆ«ä¿ç•™åŠä¸ªåˆ»åº¦é•¿åº¦çš„é—´éš” */
    let dataLen:number,baseLabelX:number; 
    if(boundaryGap){
        dataLen = this.data.length + 1
        baseLabelX = this.tickWidth / 2 //labelçš„èµ·å§‹Xåç§»åŠä¸ªåˆ»åº¦å®½åº¦
    }else{
        dataLen = this.data.length
        baseLabelX = 0
    }
    const reverseNum = reverse ? -1 : 1; //åˆ»åº¦æ˜¯å‘å†…è¿˜æ˜¯å‘å¤–
    for(i = 0; i < dataLen; i+= this.tickUnit){ //æ ¹æ®å‰é¢è®¡ç®—çš„tickUnitåˆ›å»ºå¯¹åº”åˆ»åº¦å’Œlabel
        const newX = baseX + count  * this.tickWidth; //è®¡ç®—å½“å‰åˆ»åº¦çš„x
        let start = y,end = y + tickLen * reverseNum; //è®¡ç®—åˆ»åº¦çš„èµ·å§‹Yå’Œç»ˆç‚¹Y
        let endPos = labelBase + tickLen * reverseNum  //æ ¹æ®labelBaseè®¡ç®—labelçš„Yå€¼
        const value = this.data[i];
        ticks.push(new AxisTick({x:newX,y:start},{x:newX,y:end},this.axisTickOpt))
        labels.push(new AxisLabel(newX + baseLabelX,endPos + offset * reverseNum,value));
        count++;
    }
    this.labels = labels;
    this.ticks = ticks;
}
```
[AxisTick](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/widgets/axis.ts#L39)å’Œ[AxisLabel](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/widgets/axis.ts#L33)éƒ½æ˜¯ç›´æ¥ä¼ å…¥çš„å‚æ•°åˆ†åˆ«ç»˜åˆ¶çº¿æ¡å’Œç‚¹ï¼Œæ¯”è¾ƒç®€å•ï¼Œä¸å±•å¼€è®²è§£



### XAxis
XAxisæ˜¯é€šè¿‡ä»£ç†çš„æ–¹å¼æ¥å®ç°,è€Œä¸æ˜¯ç›´æ¥ç»§æ‰¿Axis,æ›´åŠ çµæ´»
```typescript
 class XAxis implements IXAxis{
    axis:Axis
    yxisList:Array<YAxis>
    option:XAxisOption
    /* 
    * _area è¡¨ç¤ºå·²Xè½´å’ŒYè½´ä¸ºè¾¹çš„serialç»˜åˆ¶åŒºåŸŸ
    * _yaxisList è¡¨ç¤ºæ‰€æœ‰çš„Yè½´åˆ—è¡¨
    * option xè½´çš„é…ç½®é€‰é¡¹
    */
    constructor(private _area:Area, private _yaxisList:Array<YAxis> ,option:XAxisOption) {
       this.option = option
    }
    getZeroY(){
        for(let i = 0; i < this._yaxisList.length; i++){
            const yAxis = this._yaxisList[i];
            const ret = yAxis.getYByValue(0);
            if(ret != null) return ret;
        }
    }
    init(){
        const {_area,option} = this;
        const {isTop,axisOpt} = option;
        let labelBase = isTop ? _area.top : _area.bottom //Xè½´æ˜¾ç¤ºåœ¨ä¸Šé¢è¿˜æ˜¯ä¸‹é¢
        let y = this.getZeroY(); //è·å–Yè½´ä¸Š0å¯¹åº”çš„Yåæ ‡
        if(y == null){
            y = labelBase
        }
        const x = _area.x
        this.axis = new Axis(assign({boundaryGap:true},axisOpt,{
            x,
            y,
            labelBase,
            length:_area.width //serialç»˜åˆ¶åŒºåŸŸçš„å®½åº¦å°±æ˜¯è½´çš„é•¿åº¦
        }))
    }
    getXbyIndex(index:number,baseLeft:number):number{ //æ ¹æ®æ•°æ®ç‚¹çš„ä¸‹æ ‡è·å–å¯¹åº”çš„xåæ ‡
        const boundaryGapLengh = this.axis.boundaryGap ? this.axis.tickWidth / 2 : 0
        return boundaryGapLengh + index * this.axis.unitWidth + baseLeft
    }
    draw(painter:IPainter){
        this.axis.draw(painter);
    }
}
```

### YAxis
YAxisä¹Ÿæ˜¯é€šè¿‡ä»£ç†çš„æ–¹å¼æ¥å®ç°ï¼Œç›®å‰æ¥çœ‹YAxisç›¸æ¯”XAxiså¤æ‚ä¸€äº›ï¼Œå› ä¸ºå®ƒéœ€è¦æ ¹æ®æ•°æ®çš„æœ€å¤§å€¼å’Œæœ€å°å€¼è‡ªåŠ¨è®¡ç®—æ•´å½¢åˆ»åº¦å€¼

```typescript
class YAxis implements IYAxis{
    axis:Axis
    max:number
    min:number
    range:number
    axisIndex:number
    constructor(private _area:Area,private _opt:{
        isRight?:boolean,
        max:number,
        axisIndex:number,
        min:number,
        axisOpt:YAxisOpt}) {}
    init(){
        const {_area,_opt} = this;
        const {isRight,axisOpt,max,min} = _opt;
        const ret = getUnitsFromMaxAndMin(max,min) //é‡æ–°è®¡ç®—æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œé€»è¾‘ä¸‹é¢ä¼šè¯¦ç»†åˆ†æ
        this.max = ret.max;
        this.min = ret.min;
        this.range = this.max - this.min; //Yè½´çš„å€¼èŒƒå›´
        let labelBase = isRight ? _area.right : _area.left, y = _area.y 
        this.axis = new Axis(assign({},axisOpt,{
            x:labelBase,
            y,
            labelBase,
            data:ret.data,
            horizontal:false,
            boundaryGap:false,
            length:_area.height
        }) as AxisOpt)
    }
    getYByValue(val:number):number{ //æ ¹æ®å€¼è·å–Yåæ ‡,ä¾›serialç”¨
        const {range,_area,min,max} = this;
        if(max - val >= 0 && val - min >= 0){
            return _area.bottom - (val - min) * _area.height / range
        }
        return null;
    }
    draw(painter:IPainter){
        this.axis.draw(painter);
    }
}
```

[getUnitsFromMaxAndMinåˆ†æ](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/util/math.ts#L38)
```typescript
//ç›®å‰å®ç°å¾—æ¯”è¾ƒç²—æš´ï¼Œåç»­è¿˜ä¼šå†å®Œå–„
function getUnitsFromMaxAndMin(max:number,min:number,splitNumber:number = 10){
    /*å°†æœ€å¤§å’Œæœ€å°å€¼å¤„ç†æˆèƒ½è¢«10æ•´é™¤çš„*/
    max = (Math.floor(max / 10 ) + 1) * 10
    min = Math.floor(min / 10 )  * 10
    const range = max - min; //è®¡ç®—å·®å€¼
    /* æ ¹æ®å·®å€¼åˆ†å‰²æˆsplitNumberä¸ªå•ä½,æœ€ç»ˆå°±æ˜¯Yè½´çš„åˆ»åº¦ */
    let unit = Math.ceil(range / splitNumber);
    unit = (Math.floor(unit / 10) + 1) * 10
    let data = [],tmp = min;
    while(tmp < max){
        data.push(tmp);
        tmp += unit;
    }
    data.push(tmp);
    max = tmp;
    return {
        max,
        min,
        data
    }
}
```


### LineSerial
åˆ†æå®ŒAxisä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å¦‚ä½•åœ¨XAxiså’ŒYAxisçš„åŸºç¡€ä¸Šå»æ„å»ºå…·ä½“çš„LineSerialï¼Œä»£ç æ•´ä½“çœ‹ä¸Šæ¥è¿˜æ˜¯å¾ˆæ¸…æ™°çš„

```typescript
class LineSerial implements ILazyWidget{
    area:Area //Serialçš„ç»˜åˆ¶åŒºåŸŸ
    xAxis:IXAxis //å¯¹åº”çš„Xè½´
    yAxis:IYAxis //å¯¹åº”çš„Yè½´
    lineView:Line //è´Ÿè´£ç»˜åˆ¶çº¿æ¡
    tickPointList:Array<Point> //è´Ÿè´£ç»˜åˆ¶å¯¹åº”åˆ»åº¦çš„ç‚¹
    option:LineSerailOption //é…ç½®å‚æ•°
    constructor(option:LineSerailOption){
        this.option = option
    }
    init(){
        const {area,data,xAxis,yAxis,lineStyle,pointStyle} = this.option
        this.area = area;
        this.xAxis = xAxis;
        this.yAxis = yAxis;
        const tickPoints = []
        const newData = data.map((value,index)=>{
            const isTickPoint = index % xAxis.axis.tickUnit === 0; //æ ‡è®°å½“å‰ç‚¹æ˜¯å¦æ­£å¥½å¯¹åº”åˆ»åº¦
            const posX = xAxis.getXbyIndex(index,area.left) //æ ¹æ®ä¸‹æ ‡è·å–xåæ ‡
            const posY = yAxis.getYByValue(value) //æ ¹æ®å€¼è·å–yåæ ‡
            const startX = posX, startY= yAxis.getYByValue(0);
            /* è¿™å—æ˜¯åŠ¨ç”»çš„è®¡ç®—åŸºç¡€ï¼Œæœ‰åˆå§‹æ€å’Œç»ˆæ€ */
            const pos = {
                x:startX,//å½“å‰x
                y:startY, //å½“å‰y
                targetX:posX, //æœ€ç»ˆçš„x
                targetY:posY, //æœ€ç»ˆçš„x
                startX : startX, //åˆå§‹çš„x
                startY: startY //åˆå§‹çš„x
            }
            if(isTickPoint){
                //åˆ›å»ºäºåˆ»åº¦å¯¹åº”çš„æ•°æ®ç‚¹
                const tickPoint = new Point(assign({},pointStyle || {},pos))
                // åŠ å…¥åŠ¨ç”»
                Animation.addAnimationWidget(tickPoint)
                tickPoints.push(tickPoint)
    
            }
            return pos 
        })
        this.tickPointList = tickPoints
        //åˆ›å»ºçº¿æ¡
        this.lineView = new Line(newData,lineStyle) //æ ¹æ®ä¸€ç³»åˆ—åŒ…å«x,yåæ ‡çš„ç‚¹ç»˜åˆ¶å…·ä½“çš„çº¿æ¡
        Animation.addAnimationWidget(this.lineView)
    }
    draw(painter:IPainter){
        this.lineView.draw(painter);
        this.tickPointList.forEach((tickPoint)=>{
            tickPoint.draw(painter);
        })
    }
}
```

å¯¹[Line]å’Œ[Point]æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥åˆ†åˆ«ç‚¹å‡»è¿›å»çœ‹ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æ ¹æ®å‚æ•°ç»˜åˆ¶çº¿æ¡å’Œç‚¹ï¼ŒåŸºæœ¬çœ‹çœ‹å°±èƒ½çœ‹æ‡‚ï¼ŒLineé‡Œå¯ä»¥çœ‹çœ‹æ€ä¹ˆå®ç°å…‰æ»‘ç”»å›¾ï¼Œ
Pointå¯ä»¥çœ‹çœ‹æ€ä¹ˆç”»ä¸åŒå½¢çŠ¶çš„ç‚¹ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ğŸ˜Š

å¯¹[BarSerial](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/widgets/serials/barSerial.ts#L2)æ„Ÿå…´è¶£å¯ä»¥ç‚¹[è¿™é‡Œ](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/widgets/serials/barSerial.ts#L2)ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ€è·¯å»åˆ†æ

å½“ç„¶å¦‚æœä½ æœ‰æ›´å¼ºçš„æ„æ„¿ï¼Œè¿˜å¯ä»¥å»å®ç°å…¶ä»–ç±»å‹çš„Serial

### åŠ¨ç”»
æœ¬æ¬¡åŠ¨ç”»çš„å®ç°åªæ˜¯ä¸´æ—¶æ–¹æ¡ˆï¼Œåç»­ä¼šé‡æ„ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å±•å¼€äº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥åˆ°[è¿™é‡Œ](https://github.com/sheweichun/fchart/blob/Chapter_One/src/animation/index.ts)çœ‹æºç 

### fchart
å‰é¢ä»‹ç»äº†XAxisï¼ŒYAxiså’ŒLineSerialï¼Œéƒ½è¿˜æ˜¯å„è‡ªç‹¬ç«‹çš„ä¸ªä½“ï¼Œè¿™é‡Œæˆ‘è¦ä»‹ç»çš„æ˜¯å¦‚ä½•æŠŠè¿™äº›æœ‰æœºçš„ç»“åˆèµ·æ¥æœ€ç»ˆå½¢æˆæˆ‘ä»¬ç”»å‡ºæ¥çš„å›¾è¡¨

```typescript
export default class Fchart{
    XAxisList:XAxis[] = []
    YAxisList:YAxis[] = []
    series:Array<ILazyWidget>
    painter:Painter
    paddingTop:number
    paddingRight:number
    paddingBottom:number
    paddingLeft:number
    paintArea:Area
    constructor(canvas:HTMLCanvasElement,option:ChartOption){
        const mergeOption = assign({},DEFAULT_CHART_OPTION,option);
        /* åˆ›å»ºç”»ç¬” */
        this.painter = new Painter(canvas,mergeOption);
        const {padding,series,xAxis,yAxis} = mergeOption;
        this.paddingTop = padding[0];
        this.paddingRight = padding[1];
        this.paddingBottom = padding[2];
        this.paddingLeft = padding[3];
        const {width,height} = this.painter; 
        const centerX = ((width - this.paddingRight) + this.paddingLeft) / 2
        const centerY = ((height - this.paddingBottom) + this.paddingTop) / 2
        //æ ¹æ®paddingã€widthã€heightè®¡ç®—serialç»˜åˆ¶åŒºåŸŸ
        this.paintArea = new Area({
            x:centerX,
            y:centerY,
            width:width - (this.paddingLeft + this.paddingRight),
            height:height - (this.paddingTop + this.paddingBottom)
        })
        //åˆ›å»ºXè½´å’ŒYè½´
        this.createXYAxises(series,xAxis,yAxis);
        //åˆ›å»ºserial
        this.createSerialCharts(series);
        //åˆå§‹åŒ–
        this.init();
        //ç»˜å›¾
        this.draw(); 
        //å¼€å¯åŠ¨ç”»
        Animation.startAnimation(this.painter,this.draw.bind(this));
    }
    createXYAxises(series:Array<SerialOption>,xAxis:AxisOpt,yAxis:AxisOpt){
        ...
    }
    createSerialCharts(series:Array<SerialOption>,){
        ...
    }
    init(){
        this.YAxisList.forEach((yAxis)=>{
            yAxis.init();
        }) //yè½´éœ€è¦å…ˆåˆå§‹åŒ–ï¼Œxè½´ä¾èµ–yè½´å»æ‰¾0ç‚¹Yå€¼
        this.XAxisList.forEach((xAxis)=>{
            xAxis.init();
        })
        this.series.forEach((serial)=>{
            serial.init();
        })
        
    }
    draw(){
        const {painter} = this;
        this.XAxisList.forEach((xAxis)=>{
            xAxis.draw(painter)
        })
        this.YAxisList.forEach((yAxis)=>{
            yAxis.draw(painter)
        })
        this.series.forEach((serial)=>{
            serial.draw(painter)
        })
    }
}
```
è®²è§£å®Œä¸»æµç¨‹åï¼Œæˆ‘ä»¬åœ¨åˆ†æä¸‹createXYAxiseså’ŒcreateSerialChartsåˆ†åˆ«åšäº†ä»€ä¹ˆäº‹æƒ…

#### [createXYAxises](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/index.ts#L75)
```typescript
const yAxisItemList = [],xAxisItemList = []
//è¿™ä¸€éƒ¨åˆ†æ˜¯æ ¹æ®ä¼ å…¥çš„serialï¼Œè®¡ç®—ä¸åŒåºå·ä¸‹yè½´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼
series.forEach((serial)=>{
    /*yAxisIndex å¯¹åº”Yè½´çš„åºå· å¯¹åº”Xè½´çš„åºå·, è¿™é‡Œæˆ‘ä»¬çœ‹å‡ºfchartæ˜¯æ”¯æŒå¤šä¸ªè½´çš„*/
    const {data,yAxisIndex = 0,xAxisIndex = 0} = serial
    let yAxisItem = yAxisItemList[yAxisIndex];
    let xAxisItem = xAxisItemList[xAxisIndex]; 
    if(yAxisItem == null){
        yAxisItem = {max:data[0],min:data[0]}
        yAxisItemList[yAxisIndex] = yAxisItem;
    }
    if(xAxisItem == null){
        xAxisItem = {max:data[0],min:data[0]}
        xAxisItemList[xAxisIndex] = xAxisItem;
    }
    let {max,min} = maxAndMin(data,yAxisItem);
    if(min > 0) {min = 0}
    yAxisItem.min = min
    yAxisItem.max = max
    xAxisItem.min = min
    xAxisItem.max = max
})
/* åˆ›å»ºyè½´ */
this.YAxisList = yAxisItemList.map((item,index)=>{
    return new YAxis(this.paintArea,{
        max:item.max,
        min:item.min,
        axisIndex:index,
        axisOpt:(yAxis || {}) as AxisOpt
    });
})
/* åˆ›å»ºxè½´ */
this.XAxisList = xAxisItemList.map((item,index)=>{
    return new XAxis(this.paintArea,this.YAxisList,{
        axisIndex:index,
        axisOpt:(xAxis || {}) as AxisOpt
    });
})
```

#### [createSerialCharts](https://github.com/sheweichun/fchart/blob/61892f3e2613527e306baeb118636f6974493bac/src/index.ts#L111)
```typescript
/* ä»£ç çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œæ ¹æ®typeçš„ä¸åŒåˆ›å»ºå¯¹åº”çš„serial */
 const {colors} = Global.defaultConfig;
this.series = series.map((serial,index)=>{
    const {yAxisIndex = 0,xAxisIndex = 0} = serial
    const yAxis = this.YAxisList[yAxisIndex];
    const xAxis = this.XAxisList[xAxisIndex];
    const {type} = serial;
    const curColor = curItem(colors,index);
    const baseOpt = assign({},serial,{
        area:this.paintArea,
        xAxis:xAxis,
        yAxis:yAxis
    })
    if(type === 'line'){
        if(baseOpt.lineStyle == null){
            baseOpt.lineStyle = {};
        }
        baseOpt.lineStyle = baseOpt.lineStyle || {}
        baseOpt.pointStyle = baseOpt.pointStyle || {}
        baseOpt.pointStyle.borderColor = curColor
        baseOpt.lineStyle.color = curColor;
        return new LineSerial(baseOpt)
    }else if(type === 'bar'){
        baseOpt.barStyle = baseOpt.barStyle || {color:null}
        baseOpt.barStyle.color = curColor;
        xAxis.option.axisOpt.boundaryGap = true;
        return new BarSerial(baseOpt)
    }
})
```


## å¼€å‘

æœ¬åº“é€‰ç”¨parcelå¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œä¸ç†Ÿæ‚‰çš„åŒå­¦å¦‚æœå¯¹parcelæ„Ÿå…´è¶£å¯ä»¥å»[å®˜ç½‘](https://parceljs.org)äº†è§£äº†è§£ï¼Œæ²¡å…´è¶£ä¹Ÿæ²¡å…³ç³»ï¼ŒæŒ‰ç…§ä»¥ä¸‹æŒ‡ç¤ºä¹Ÿæ˜¯èƒ½è·‘èµ·demoæ¥çš„


### å®‰è£…ä¾èµ–
```bash
npm install
```


### å¼€å‘é¢„è§ˆdemo

```bash
npm run dev
```

<p align="center">
    <img  src="https://user-gold-cdn.xitu.io/2019/4/10/16a055f03c53753f?w=258&h=258&f=png&s=7273"><br/>
    <span>FE One</span>
</p>

<center style="font-size:12px;color:#999;">å…³æ³¨æˆ‘ä»¬çš„å…¬ä¼—å·FE Oneï¼Œä¼šä¸å®šæœŸåˆ†äº«JSå‡½æ•°å¼ç¼–ç¨‹ã€æ·±å…¥Reactionã€Rxjsã€å·¥ç¨‹åŒ–ã€WebGLã€ä¸­åå°æ„å»ºç­‰å‰ç«¯çŸ¥è¯†<center>

